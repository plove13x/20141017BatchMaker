window.BM=Ember.Application.create(),filepicker.setKey("AJE3cnY7SdaNS7tkXqQwgz"),BM.ref=new Firebase("https://plovebatchmaker.firebaseio.com/"),BM.ApplicationAdapter=DS.FirebaseAdapter.extend({firebase:BM.ref}),BM.Router.map(function(){this.resource("index",{path:"/"}),this.route("login"),this.route("register"),this.route("settings"),this.resource("user",{path:"/:id"}),this.resource("recipes",function(){this.route("create"),this.route("display",{path:":recipe_id"}),this.route("edit",{path:":recipe_id/edit"})})}),BM.ApplicationRoute=Ember.Route.extend({model:function(){}}),BM.IndexRoute=Ember.Route.extend({beforeModel:function(){console.log(this.controllerFor("application").get("user")),null===this.controllerFor("session").get("currentUser")&&this.transitionTo("login")},model:function(){return Ember.RSVP.hash({recipes:this.store.find("recipe")})},setupController:function(e,t){this._super(e,t),e.set("recipes",t.recipes),e.set("myRecipes",t.recipes)}}),BM.UserRoute=Ember.Route.extend({model:function(){return this.store.find("user",this.controllerFor("session").get("currentUser")).then(function(e){return e.get("recipes")})}}),BM.RecipesRoute=Ember.Route.extend({model:function(){return this.store.find("recipe")}}),BM.RecipesCreateRoute=Ember.Route.extend({setupController:function(e,t){this._super(e,t);var r=this.store.createRecord("ingredientFood",{}),s=this.store.createRecord("step",{});s.get("ingredients").addObject(r),e.set("steps",[s])}}),BM.ApplicationController=Ember.ObjectController.extend({}),BM.LoginController=Ember.Controller.extend({needs:["session"],actions:{logIn:function(){console.log(this.get("controllers.session.currentUser"));var e=this.getProperties("email","password");this.get("controllers.session").authenticate(e),console.log(this.get("controllers.session.currentUser")),this.transitionToRoute("recipes")}}}),BM.RegisterController=Ember.Controller.extend({needs:["session"],actions:{createUser:function(){var e=this.getProperties("email","password"),t=this;return new Ember.RSVP.Promise(function(r){BM.ref.createUser(e,function(s){s||BM.ref.authWithPassword(e,function(s,o){var n=t.store.createRecord("user",{id:o.uid,email:e.email});n.save(),localStorage.setItem("currentUser",n),t.controllerFor("session").set("currentUser",n),r(o),console.log(n),console.log(t.controllerFor("session").get("currentUser"))})})})}}}),BM.SessionController=Ember.Controller.extend({currentUser:null,authenticate:function(e){var t=this;return new Ember.RSVP.Promise(function(r){BM.ref.authWithPassword(e,function(e,s){console.log(s),t.store.find("user",s.uid).then(function(e){t.set("currentUser",e),localStorage.setItem("currentUser",e),r(s),console.log(t.get("currentUser"))})})})}}),BM.IndexController=Ember.Controller.extend({}),BM.UserController=Ember.Controller.extend({needs:"session",currentUser:Ember.computed.alias("controllers.session.currentUser")}),BM.RecipesController=Ember.ArrayController.extend({}),BM.RecipesCreateController=Ember.Controller.extend({needs:"session",recipeName:"",recipeDetails:"",currentUser:Ember.computed.alias("controllers.session.currentUser"),rTypes:["Breakfast","Lunch","Dinner","Dessert"],degreeScale:["°F","°C"],init:function(){console.log(this.get("currentUser"))},actions:{addStep:function(){var e=this.store.createRecord("step",{});this.get("steps").addObject(e);var t=this.store.createRecord("ingredientFood",{});e.get("ingredients").addObject(t)},addImage:function(){var e=this;filepicker.pickAndStore({mimetype:"image/*"},{},function(t){var r=t[0].url;e.set("url",r)})},createRecipe:function(){var e=this.get("currentUser");console.log(e);var t=this.store.createRecord("recipe",{name:this.get("recipeName"),url:this.get("url"),isPrivate:this.get("isPrivate"),rType:this.get("rType"),prepTime:this.get("prepTime"),cookTime:this.get("cookTime"),cookTemp:this.get("cookTemp"),dScale:this.get("dScale"),rQty:this.get("rQty"),qtyType:this.get("qtyType"),pNotes:this.get("pNotes"),user:e});t.get("steps").addObjects(this.get("steps")),t.save().then(function(){e.get("recipes").then(function(r){r.addObject(t),e.save()})}),this.set("recipeName",""),this.set("prepTime",""),this.set("cookTime",""),this.set("cookTemp",""),this.set("rQty",""),this.set("qtyType",""),this.set("pNotes",""),this.set("ingrAmnt","")}}}),BM.StepController=Ember.ObjectController.extend({actions:{addIngredient:function(){var e=this.store.createRecord("ingredientFood",{});this.get("ingredients").addObject(e)}}}),BM.IngredientController=Ember.ObjectController.extend({unitTypes:["cups","ounces"]}),BM.User=DS.Model.extend({name:DS.attr("string"),email:DS.attr("string"),password:DS.attr("string"),recipes:DS.hasMany("recipe",{async:!0})}),BM.Recipe=DS.Model.extend({name:DS.attr("string"),url:DS.attr("string"),user:DS.belongsTo("user"),isPrivate:DS.attr("boolean"),rType:DS.attr("string"),prepTime:DS.attr("string"),cookTime:DS.attr("string"),cookTemp:DS.attr("number"),dScale:DS.attr("string"),rQty:DS.attr("number"),qtyType:DS.attr("string"),pNotes:DS.attr("string"),steps:DS.hasMany("step",{embedded:!0})}),BM.Step=DS.Model.extend({ingredients:DS.hasMany("ingredientFood",{embedded:!0}),description:DS.attr("string")}),BM.IngredientFood=DS.Model.extend({name:DS.attr("string"),ingrAmnt:DS.attr("number"),unitType:DS.attr("string")});